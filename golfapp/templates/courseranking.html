{% extends "base.html" %}

{% block title %}View Rounds{% endblock title %}
{% block home %}active{% endblock home %}


{% block content %}
<script>
  const GET_RANKING_DATA_URL = "{{ url_for('home.get_course_ranking_data', user_id=user_id) }}";
  const COURSE_RANKING_EDIT = "{{ url_for('home.course_ranking', user_id=user_id) }}";
  const IS_ME = "{{ is_me }}" === "True";
</script>

<div class="container">
  <table class="table table-striped-even">
    <thead>
      <tr>
        <th>Rank</th>
        <th>Course</th>
        <th>Rating</th>
        {% if is_me %}
          <th></th>
        {% endif %}
      </tr>
    </thead>
    <tbody>
      {% if is_me %}
        <tr>
          <form action="{{ url_for('home.course_ranking', user_id=current_user.id) }}" method="POST">
            <td></td>
            <td>
              <select name="course" id="course" class="form-select">
                <option value="" selected disabled hidden>Select course</option>
              </select>
            </td>
            <td>
              <input class="form-control" type="number" step="0.01" name="rating" placeholder="Rating" max="10" required>
            </td>
            <td>
              <button class="btn btn-primary" type="submit">Add rating</button>
            </td>
          </form>
        </tr>
      {% endif %}
      <div id="ranking"></div>
    </tbody>
  </table>
</div>

<script src="/static/js/courseRanking.js"></script>
<script async>
  async function get_page_data() {
    let respone = await fetch(GET_RANKING_DATA_URL);
    let data = await respone.json();

    const COURSE_RANKING = new CourseRanking(data.courses, data.ranking_data);
  }

  get_page_data();
</script>

{% endblock content %}